@page "/login"
@layout Layout.MainLayout
@rendermode InteractiveServer
@inject Authentication Auth
@inject NavigationManager Nav
<PageTitle>Login</PageTitle>

<div class="login-background"></div>

<div class="div-login">
    <div class="immagine-logo">
        <img src="/images/Logo.png"/>
    </div>
    <div class="Box-Login-text">
        <p>Questo Ã¨ un piccolo gestionale creato Interamente da un singolo sviluppatore Leonardo Ringressi, spero diventi qualcosa di utile</p>
    </div>
    <div class="inputs-login">
        <form method="post" action="/api/login">
            <input name="Username" type="text" placeholder="Nome Utente" />
            <input name="Password" type="password" placeholder="Password" />
            <button type="submit">Accedi</button>
        </form>
        <p>@warning</p>
    </div>
</div>

@code{
    string password="";
    string nome="";
    string warning ="";
    private async Task DoLogin()
{
    var ok = await Auth.LoginAsync(nome, password);

    if (ok)
    {
        await Auth.CreateSession(nome);
        Nav.NavigateTo("/home", true); // reload completo
    }
    else
    {
        warning = "Username o Password sbagliati";
        nome = "";
        password = "";
    }
}

}

